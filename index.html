<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My AI Interface</title>
    <!-- Load Puter v2 -->
    <script src="https://js.puter.com/v2/"></script>
</head>
<body>
    <h1>Playwright AI Controller</h1>
    <div id="status">Initializing...</div>
    
    <!-- Login Button (Visible only if needed) -->
    <button id="login-btn" style="display:none; padding: 20px; font-size: 20px;" onclick="puter.auth.signIn()">
        CLICK HERE TO LOGIN ONCE
    </button>

    <script>
        const statusDiv = document.getElementById('status');
        const loginBtn = document.getElementById('login-btn');

        // Check login status immediately
        if (puter.auth.isSignedIn()) {
            statusDiv.innerText = "Ready for Python";
        } else {
            statusDiv.innerText = "Login Required";
            loginBtn.style.display = 'block';
        }

        // --- THE API FUNCTION ---
        // Python Playwright will call this function!
        window.generateText = async (prompt, model) => {
            try {
                statusDiv.innerText = "Thinking...";
                
                // This runs in the browser, so it uses your cookies (Free!)
                const response = await puter.ai.chat(prompt, {
                    model: model || 'gemini-2.0-flash'
                });

                statusDiv.innerText = "Done";
                
                // Return clean text to Python
                if (response?.message?.content) {
                    return response.message.content;
                }
                return JSON.stringify(response);

            } catch (err) {
                return "Error: " + err.message;
            }
        };
    </script>
</body>
</html>